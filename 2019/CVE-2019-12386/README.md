# CVE-2019-12386: Stored XSS in Ampache
[![](https://img.shields.io/badge/Attack%20Vector-Remote-red?style=flat-square)]() [![](https://img.shields.io/badge/Privileges%20Required-Low-yellow?style=flat-square)]() [![](https://img.shields.io/badge/User%20Interaction-Yes-green?style=flat-square)]()


__Vendor:__ Ampache<br>
__Vendor URL:__ http://ampache.org<br>
__Versions affected:__ Ampache <= 3.9.1<br>
__Discovered by:__ Juan Manuel Fernandez ([@TheXC3LL](https://twitter.com/TheXC3LL))<br>
__Public fix:__ Yes<br>
__Proof of Concept:__ Yes ([ref](https://github.com/blackarrowsec/advisories/blob/master/2019/CVE-2019-12386/CVE-2019-12386.html)) <br>


## Summary
Ampache 3.9.1 (and before) is vulnerable to stored XSS because they user parameters are used without a properly sanitization.

## Details

A stored XSS exists in the localplay.php LocalPlay "add instance" functionality. The injected code is reflected in the instances menu. This vulnerability can be abused to force an admin to create a new privileged user whose credentials are known by the attacker.

## Impact
This vulnerability can be abused to force an admin to create a new privileged user whose credentials are known by the attacker.

## Recommendation
Update to last version.

## Timeline

* 25/04/2019 - Reported vulnerability to vendor
* 24/06/2019 - First fix attempt
* 25/06/2019 - Incorrect fix notification
* 25/06/2019 - Final fix at Github

#

[![](https://img.shields.io/badge/www-blackarrow.net-E5A505?style=flat-square)](https://www.blackarrow.net) [![](https://img.shields.io/badge/twitter-@BlackArrowSec-00aced?style=flat-square&logo=twitter&logoColor=white)](https://twitter.com/BlackArrowSec) [![](https://img.shields.io/badge/linkedin-@BlackArrowSec-0084b4?style=flat-square&logo=linkedin&logoColor=white)](https://www.linkedin.com/company/blackarrowsec/)